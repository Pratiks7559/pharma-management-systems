{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/sale_rate_list.css' %}">
{% endblock %}

{% block content %}

<div class="sale-rate-list-container">
    <!-- Page Heading -->
    <div class="sale-rate-list-header">
        <h1 class="sale-rate-list-title">Batch-Specific Sale Rates</h1>
        <a href="{% url 'add_sale_rate' %}" class="sale-rate-list-add-btn">
            <i class="fas fa-plus sale-rate-list-add-icon"></i> Add New Rate
        </a>
    </div>

    <!-- Search Bar -->
    <div class="sale-rate-list-search-card">
        <div class="sale-rate-list-search-header">
            <h6 class="sale-rate-list-search-title">Search Rates</h6>
        </div>
        <div class="sale-rate-list-search-body">
            <form method="GET" action="{% url 'sale_rate_list' %}" class="sale-rate-list-search-form">
                <div class="sale-rate-list-search-group">
                    <input type="text" name="search" class="sale-rate-list-search-input" placeholder="Search by product name or batch number" value="{{ search_query }}">
                    <div class="sale-rate-list-search-btn-wrapper">
                        <button type="submit" class="sale-rate-list-search-btn">
                            <i class="fas fa-search sale-rate-list-search-icon"></i>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Sale Rates Table -->
    <div class="sale-rate-list-table-card">
        <div class="sale-rate-list-table-header">
            <h6 class="sale-rate-list-table-title">Sale Rates</h6>
        </div>
        <div class="sale-rate-list-table-body">
            <div class="sale-rate-list-table-wrapper">
                <table class="sale-rate-list-table" width="100%" cellspacing="0">
                    <thead class="sale-rate-list-table-head">
                        <tr class="sale-rate-list-table-header-row">
                            <th class="sale-rate-list-product-header">Product</th>
                            <th class="sale-rate-list-company-header">Company</th>
                            <th class="sale-rate-list-batch-header">Batch No</th>
                            <th class="sale-rate-list-rate-a-header">Rate A</th>
                            <th class="sale-rate-list-rate-b-header">Rate B</th>
                            <th class="sale-rate-list-rate-c-header">Rate C</th>
                            <th class="sale-rate-list-actions-header">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="sale-rate-list-table-tbody">
                        {% for rate in sale_rates %}
                        <tr class="sale-rate-list-table-row">
                            <td class="sale-rate-list-product-cell">{{ rate.productid.product_name }}</td>
                            <td class="sale-rate-list-company-cell">{{ rate.productid.product_company }}</td>
                            <td class="sale-rate-list-batch-cell">{{ rate.product_batch_no }}</td>
                            <td class="sale-rate-list-rate-a-cell">{{ rate.rate_A }}</td>
                            <td class="sale-rate-list-rate-b-cell">{{ rate.rate_B }}</td>
                            <td class="sale-rate-list-rate-c-cell">{{ rate.rate_C }}</td>
                            <td class="sale-rate-list-actions-cell">
                                <a href="{% url 'update_sale_rate' rate.pk %}" class="sale-rate-list-edit-btn">
                                    <i class="fas fa-edit sale-rate-list-edit-icon"></i>
                                </a>
                                <a href="{% url 'delete_sale_rate' rate.pk %}" class="sale-rate-list-delete-btn">
                                    <i class="fas fa-trash sale-rate-list-delete-icon"></i>
                                </a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr class="sale-rate-list-empty-row">
                            <td colspan="7" class="sale-rate-list-empty-cell">No sale rates found.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            {% if sale_rates.has_other_pages %}
            <div class="sale-rate-list-pagination">
                <ul class="sale-rate-list-pagination-list">
                    {% if sale_rates.has_previous %}
                    <li class="sale-rate-list-pagination-item">
                        <a href="?page={{ sale_rates.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="sale-rate-list-pagination-link">
                            <i class="fas fa-angle-left sale-rate-list-pagination-icon"></i>
                        </a>
                    </li>
                    {% else %}
                    <li class="sale-rate-list-pagination-item sale-rate-list-pagination-disabled">
                        <a href="#" class="sale-rate-list-pagination-link"><i class="fas fa-angle-left sale-rate-list-pagination-icon"></i></a>
                    </li>
                    {% endif %}

                    {% for i in sale_rates.paginator.page_range %}
                    {% if sale_rates.number == i %}
                    <li class="sale-rate-list-pagination-item sale-rate-list-pagination-active">
                        <a href="#" class="sale-rate-list-pagination-link">{{ i }}</a>
                    </li>
                    {% else %}
                    <li class="sale-rate-list-pagination-item">
                        <a href="?page={{ i }}{% if search_query %}&search={{ search_query }}{% endif %}" class="sale-rate-list-pagination-link">{{ i }}</a>
                    </li>
                    {% endif %}
                    {% endfor %}

                    {% if sale_rates.has_next %}
                    <li class="sale-rate-list-pagination-item">
                        <a href="?page={{ sale_rates.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="sale-rate-list-pagination-link">
                            <i class="fas fa-angle-right sale-rate-list-pagination-icon"></i>
                        </a>
                    </li>
                    {% else %}
                    <li class="sale-rate-list-pagination-item sale-rate-list-pagination-disabled">
                        <a href="#" class="sale-rate-list-pagination-link"><i class="fas fa-angle-right sale-rate-list-pagination-icon"></i></a>
                    </li>
                    {% endif %}
                </ul>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}







